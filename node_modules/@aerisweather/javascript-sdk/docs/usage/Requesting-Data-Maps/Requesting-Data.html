<h1 id="data-requests" class="page-title">Data Requests</h1>
<p>Once you’ve setup the SDK either for the <a href="/support/docs/toolkits/aeris-js-sdk/getting-started/script-usage/">browser</a> or as an <a href="/support/docs/toolkits/aeris-js-sdk/getting-started/module-usage/">NPM module</a>, getting data into your application is easy using the <a href="/docs/js/classes/aerisweather.html"><code>AerisWeather</code></a> class.</p>
<p>Data requests are made using an instance of <a href="/docs/js/classes/apirequest.html"><code>ApiRequest</code></a> and interact with the Aeris Weather API. The SDK returns a JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> when performing the asynchronous requests using the <a href="/docs/js/classes/apirequest.html#get"><code>get()</code></a> method on a request. This allows you to handle the response’s result on completion of the request. Furthermore, you can also use JavaScript’s <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await"><code>async/await</code></a> operators to mimic syncronous requests for data instead of relying on a Promise callback function.</p>
<h3 id="creating-an-apirequest">Creating an ApiRequest</h3>
<p>Use the <a href="/docs/js/classes/aerisweather.html#api"><code>api()</code></a> method on your initialized <code>AerisWeather</code> instance, which will return a new data request instance that you can configure further:</p>
<pre class="language-javascript"><code>// create the request instance
const request = aeris.api();

// configure the request endpoint
request.endpoint(&#39;forecasts&#39;);

// set the place to request data for
request.place(&#39;seattle,wa&#39;);

// configure the request options
request.filter(&#39;daynight&#39;).limit(2);

// perform the request and output the data
request.get().then((result) =&gt; {
    // returned data will be accessible on `result.data` 
    console.log(result.data);
});</code></pre>
<p>The result that is returned to your Promise callback (or variable assignment when using <code>async/await</code>) will be an instance of <a href="/docs/js/classes/apiresult.html"><code>ApiResult</code></a>, which contains not only the data returned in the response, but other information about the response. You will typically only be accessing the <code>result.data</code> property as that is the actual data returned by the API for your request.</p>
<h4 id="promise-vs-callback-function-vs-asyncawait">Promise vs Callback Function vs Async/Await</h4>
<p>When performing your request using the <code>get()</code> method, you can either use the returned Promise to handle the response or include a callback function as the method’s only argument. Your callback function will be called with the result on completion of the request:</p>
<pre class="language-javascript"><code>// perform the request and output the data using a callback function
request.get((result) =&gt; {
    // returned data will be accessible on `result.data`
    console.log(result.data);
});</code></pre>
<p>Alternatively, you can use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function"><code>async/await</code></a> if you’re performing the request within an <code>async</code> function:</p>
<pre class="language-javascript"><code>// perform the request using async/await
const loadData = async () =&gt; {
    const result = await request.get();
    console.log(result.data);
};

loadData();</code></pre>
<p class="alert alert-info">Remember, the <code>await</code> keyword is only valid inside <code>async</code> functions. If you use it outside of an <code>async</code> function’s body, you will get a syntax error.</p>
<h2 id="methods">Methods</h2>
<p>The following methods are available when configuring an <a href="/docs/js/classes/apirequest.html"><code>ApiRequest</code></a> instance:</p>
<table class="table">
	<thead>
		<tr class="header">
			<th>Method</th>
			<th>Value Type</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr class="odd">
			<td><code>action(:value)</code></td>
			<td><code>string</code></td>
			<td>Sets the action for the request.</td>
		</tr>
		<tr class="even">
			<td><code>bounds(:value)</code></td>
			<td><a href="/docs/js/interfaces/icoordinatebounds.html"><code>ICoordinateBounds</code></a></td>
			<td>Sets the request’s place to the coordinate bounds string.</td>
		</tr>
		<tr class="odd">
			<td><code>endpoint(:value)</code></td>
			<td><code>string</code></td>
			<td>Sets the endpoint for the request (required).</td>
		</tr>
		<tr class="even">
			<td><code>fields(:value)</code></td>
			<td><code>string</code></td>
			<td>A comma-delimited list of response properties for the API to return. This parameter is often used to limit the amount of data returned.</td>
		</tr>
		<tr class="odd">
			<td><code>filter(:value)</code></td>
			<td><code>string</code></td>
			<td>Predefined filters for limiting the results. The filter value can be a single, comma-delimited or a semicolon delimited string of filter names.</td>
		</tr>
		<tr class="even">
			<td><code>from(:value)</code></td>
			<td><code>string</code>, <code>Date</code></td>
			<td>Either a <code>Date</code> or <a href="http://php.net/manual/en/datetime.formats.php">valid time string</a> from which to return results for.</td>
		</tr>
		<tr class="odd">
			<td><code>limit(:value)</code></td>
			<td><code>number</code></td>
			<td>Maximum number of results to return.</td>
		</tr>
		<tr class="even">
			<td><code>place(:value)</code></td>
			<td><code>string</code></td>
			<td>Location to request data for. Refer to the list of <a href="https://www.aerisweather.com/support/docs/api/reference/places/">supported place values</a>.</td>
		</tr>
		<tr class="odd">
			<td><code>plimit(:value)</code></td>
			<td><code>number</code></td>
			<td>Applied only on the <code>periods</code> response property, the total number of periods to return as an integer.</td>
		</tr>
		<tr class="even">
			<td><code>pskip(:value)</code></td>
			<td><code>number</code></td>
			<td>Applied only on the <code>periods</code> response property, used to skip over a specific number of periods in the data set.</td>
		</tr>
		<tr class="odd">
			<td><code>psort(:value)</code></td>
			<td><code>string</code></td>
			<td>Applied only on the <code>periods</code> response property, used to sort results based on certain fields contained within the periods.</td>
		</tr>
		<tr class="even">
			<td><code>query(:value)</code></td>
			<td><code>string</code></td>
			<td>Filters results based on certain fields and values in the dataset. Refer to the <a href="https://www.aerisweather.com/support/docs/api/getting-started/queries/">advanced queries</a> documentation.</td>
		</tr>
		<tr class="odd">
			<td><code>radius(:value)</code></td>
			<td><code>string</code></td>
			<td>When requesting the closest results within a circle, the radius determines how far from the specified location to search. A valid unit value must be included in your radius value, e.g., <code>5mi</code>, <code>10km</code>, <code>25miles</code>. If no unit is provided, your value is assumed to be in meters by default.</td>
		</tr>
		<tr class="even">
			<td><code>skip(:value)</code></td>
			<td><code>number</code></td>
			<td>Skips over a specific number of results in the dataset.</td>
		</tr>
		<tr class="odd">
			<td><code>sort(:value)</code></td>
			<td><code>string</code></td>
			<td>Sorts results based on certain fields in the dataset. Refer to the <a href="https://www.aerisweather.com/support/docs/api/getting-started/sorting/">sorting</a> documentation.</td>
		</tr>
		<tr class="even">
			<td><code>to(:value)</code></td>
			<td><code>string</code>, <code>Date</code></td>
			<td>Either a <code>Date</code> or <a href="http://php.net/manual/en/datetime.formats.php">valid time string</a> up to which to return results for. When used in conjunction with <code>from()</code>, this value be relative to the <em>from</em> value, not relative to the current time.</td>
		</tr>
	</tbody>
</table>
<p>The following are additional methods available when working with request instances:</p>
<table class="table">
	<thead>
		<tr class="header">
			<th>Method</th>
			<th>Value Type</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr class="odd">
			<td><code>get(:callback)</code></td>
			<td><code>Function</code></td>
			<td>Performs the request. Returns a Promise that can be used to handle the result. Alternatively, a callback function can be passed to handle the result.</td>
		</tr>
		<tr class="even">
			<td><code>url()</code></td>
			<td></td>
			<td>Returns the url string for the request based on the configured parameters and options.</td>
		</tr>
		<tr class="odd">
			<td><code>cancel()</code></td>
			<td></td>
			<td>Cancels the request.</td>
		</tr>
		<tr class="even">
			<td><code>param(:key, :value)</code></td>
			<td><code>string</code>, <code>any</code></td>
			<td>Sets or returns the specified parameter. If a value is provided, then the option will be set. Otherwise the current value will be returned.</td>
		</tr>
		<tr class="odd">
			<td><code>setParams(:value)</code></td>
			<td><code>ApiRequest</code></td>
			<td>Updates the request’s configuration using the specified options object.</td>
		</tr>
		<tr class="even">
			<td><code>clone()</code></td>
			<td></td>
			<td>Returns an identical duplicate of the request instance.</td>
		</tr>
	</tbody>
</table>
<h2 id="request-result">Request Result</h2>
<p>The Promise or callback function from the call to <code>get()</code> to perform the request will receive one argument, which is the result of the request. This result will be an instance of <a href="/docs/js/classes/apiresult.html"><code>ApiResult</code></a> containing various pieces of information related to the request and response.</p>
<p>The following properties are returned with each <code>ApiResult</code> instance:</p>
<table class="table">
	<thead>
		<tr class="header">
			<th>Property</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr class="odd">
			<td><code>data</code></td>
			<td>Response data provided by the API.</td>
		</tr>
		<tr class="even">
			<td><code>error</code></td>
			<td>Error that occurred during the request, if any.</td>
		</tr>
		<tr class="odd">
			<td><code>params</code></td>
			<td>Request parameters that were used.</td>
		</tr>
		<tr class="even">
			<td><code>response</code></td>
			<td>Response object returned by the request.</td>
		</tr>
	</tbody>
</table>
<p>Typically you will be most interested in the <code>data</code> property as that will contain the data returned by the API for your request.</p>
<h2 id="batch-requests">Batch Requests</h2>
<p>An <code>ApiRequest</code> instance can easily be converted into a batch request simply by adding child requests to it using the <a href="/docs/js/classes/apirequest.html#addrequest"><code>addRequest()</code></a> method on a request:</p>
<pre class="language-javascript"><code>const obsRequest = aeris.api().endpoint(&#39;observations&#39;);
const forecastRequest = aeris.api().endpoint(&#39;forecasts&#39;).limit(2);

// create a single request using Austin, TX as the place
const request = aeris.api().place(&#39;austin,tx&#39;);

// adding child requests will convert the parent request into a batch request
// whose configured options will be applied globally across all child requests
request.addRequest(obsRequest);
request.addRequest(forecastRequest);
request.get().then((result) =&gt; {
    // returned data will be be formatted as a batch request
    console.log(result.data);
});</code></pre>
<p>You can then remove one or all child requests from a request instance:</p>
<pre class="language-javascript"><code>// remove a single child request
request.removeRequest(forecastRequest);

// remove all requests
request.removeAllRequests();</code></pre>
<p>Note that removing all child requests will convert the parent request instance back to a non-batch request.</p>
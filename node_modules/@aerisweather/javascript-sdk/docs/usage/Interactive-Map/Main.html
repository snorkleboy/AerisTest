<h1 id="interactive-map" class="page-title">Interactive Map</h1>
<p>Getting started with an interactive weather map is quick and easy. Simply follow the <a href="/support/docs/toolkits/aeris-js-sdk/getting-started/">Getting Started</a> guide for the JavaScript SDK, and then determine the third-party mapping library and its associated key you wish to use from those we currently support:</p>
<table class="table">
	<thead>
		<tr class="header">
			<th>Key</th>
			<th>Library</th>
		</tr>
	</thead>
	<tbody>
		<tr class="odd">
			<td><code>leaflet</code></td>
			<td><a href="https://leafletjs.com">Leaflet</a>, version 1.3.0+</td>
		</tr>
		<tr class="even">
			<td><code>mapbox</code></td>
			<td><a href="https://www.mapbox.com/mapbox-gl-js/">Mapbox GL</a>, version 0.50.0+</td>
		</tr>
		<tr class="odd">
			<td><code>openlayers</code></td>
			<td><a href="https://openlayers.org">OpenLayers</a>, version 5.0.0+</td>
		</tr>
		<tr class="even">
			<td><code>google</code></td>
			<td><a href="https://developers.google.com/maps/documentation/javascript/">Google Maps</a>, version 3.30+</td>
		</tr>
	</tbody>
</table>
<p class="alert alert-info">The interactive map feature is part of the <strong>Views</strong> module of the library. Therefore, you’ll need to use the <code>views()</code> method on your <code>AerisWeather</code> instance in order to begin using any of the map view-related features. <a href="/support/docs/toolkits/aeris-js-sdk/getting-started/views-module/">Read more</a> about working with the <strong>Views</strong> module.</p>
<h3 id="getting-started">Getting Started</h3>
<p>Initialize your interactive weather map with your DOM target where it will be rendered and desired <a href="./configuration/">configuration options</a> using the <code>new views.InteractiveMap(target, opts)</code> constructor. For example, the following will render a weather map in the DOM target with id <code>ia-map</code> using the Leaflet mapping library initialized at zoom level 4 with radar and satellite layers:</p>
<pre class="language-javascript"><code>// using Promises
aeris.views().then((views) =&gt; {
    const map = new views.InteractiveMap(&#39;#map&#39;, {
        strategy: &#39;leaflet&#39;,
        zoom: 4,
        layers: &#39;satellite,radar&#39;
    });
    
    // must wait for map to be ready before trying to update its view
    map.on(&#39;ready&#39;, () =&gt; {
        map.setCenter({ lat: 47.5, lon: -121.5 });
        map.setZoom(6);
    });
});</code></pre>
<figure>
	<img src="/docs/js/img/awxjs-interactivemap-init-basic.png" alt="Interactive map using the Leaflet JS mapping library" />
	<figcaption>Interactive map using the Leaflet JS mapping library</figcaption>
</figure>
<p>Alternatively, if you’re providing a callback function to the <code>views()</code> method:</p>
<pre class="language-javascript"><code>// using callback function
aeris.views((views) =&gt; {
    const map = new views.InteractiveMap(&#39;#map&#39;, {
        zoom: 4,
        layers: &#39;satellite,radar&#39;
    });
    
    // must wait for map to be ready before trying to update its view
    map.on(&#39;ready&#39;, () =&gt; {
        map.setCenter({ lat: 47.5, lon: -121.5 });
        map.setZoom(6);
    });
});</code></pre>
<p class="alert alert-info"><strong>Note:</strong> Any updates to the map, such as changing the viewport, starting the animation, and/or adding and removing layers, must occur <strong>after</strong> the map has been fully initialized and loaded. Therefore, you’ll need to perform these changes within an event handler on the map’s <a href="./events/"><code>ready</code> event</a> as demonstrated in the above examples.</p>
<h3 id="using-an-existing-map">Using an Existing Map</h3>
<p>By default, the library will automatically create a map instance based on your configured map strategy when first initializing an interactive map. However, you may already have a map instance setup that you just want to add all of the weather-related functionality the library provides.</p>
<p>Fortunately, an interactive map allows you to provide a reference to your pre-existing map instance instead of a DOM target. The interactive map will then use this map instance instead of creating a new one. Also, the library will automatically determine which mapping strategy to use based on the type of the map instance you provide, overriding the <code>strategy</code> value in your configuration.</p>
<p>For instance, my application already uses a Mapbox map instance, and I just want to add weather data onto it. Simply pass in a reference to your pre-existing map instance as the first argument to <code>aeris.interactive()</code>:</p>
<pre class="language-javascript"><code>// create a Mapbox map instance
mapboxgl.accessToken = &#39;MAPBOX_TOKEN&#39;;

const mapboxMap = new mapboxgl.Map({
    container: document.getElementById(&#39;map&#39;),
    style: &#39;mapbox://styles/mapbox/streets-v8&#39;,
    center: [-119.8138, 39.5296],
    zoom: 5
});

aeris.views().then((views) =&gt; {
    const map = new views.InteractiveMap(mapboxMap, {
        layers: &#39;radar&#39;,
        timeline: {
            from: -3 * 3600,
            to: 0
        }
    });

    // must wait for map to be ready before trying to update its view
    map.on(&#39;ready&#39;, () =&gt; {
        map.setCenter({ lat: 47.5, lon: -121.5 });
        map.setZoom(6);
    });
});</code></pre>
<p>And that’s it! Your interactive map will now use your existing map instance for all weather-related functionality:</p>
<figure>
	<img src="/docs/js/img/awxjs-interactivemap-init-mapbox-existing.png" alt="Interactive map an existing Mapbox map" />
	<figcaption>Interactive map an existing Mapbox map</figcaption>
</figure>
<h2 id="adding-and-removing-weather-data">Adding and Removing Weather Data</h2>
<p>Adding and removing weather layers once you’ve created your map instance is simple. All you need is the layer code associated with the layer you want to add, which is typically the same as the <a href="/support/docs/aeris-maps/reference/map-layers/">Aeris Maps (AMP) layer code</a>.</p>
<p>Refer to the <a href="./managing-layers/">Managing Layers</a> documentation for more information on adding and removing weather data with your map.</p>
<h2 id="animating-weather-data">Animating Weather Data</h2>
<p>A map’s animation is controlled by a single <a href="./timeline/">timeline</a>, which is responsible for animating map data across a time period. The timeline will have a starting and ending date and time and only data within that time range will appear on the map.</p>
<p>To begin playing a map animation, use <code>play()</code> on the map’s <code>timeline</code> property:</p>
<pre class="language-javascript"><code>map.timeline.play();</code></pre>
<p>Stopping an animation is similar, except using the <code>stop()</code> method on the timeline:</p>
<pre class="language-javascript"><code>map.timeline.stop();</code></pre>
<p>You can also check if the map timeline is currently animating, which is useful to create a simple animation toggle function for a button click event handler:</p>
<pre class="language-javascript"><code>const btnToggle = document.getElementById(&#39;btn-toggle&#39;);
btnToggle.addEventListener(&#39;click&#39;, (e) =&gt; {
    e.preventDefault();
    if (map.timeline.isAnimating()) {
        map.timeline.stop();
    } else {
        map.timeline.play();
    }
});</code></pre>
<p>Refer to the <a href="./timeline/">Timeline</a> documentation for more information on configuring your map’s date range and its animation.</p>
<h2 id="styling-map-data">Styling Map Data</h2>
<p>The weather data that gets rendered to your interactive map can be use fully customizable styling based on your application needs. In most cases the default styles will work well. However, the map is flexible enough to allow you to override or modify how layers get rendered to the map.</p>
<p>Currently, point and shape layers are the most customizable as they are drawn by the mapping library. On the other hand, raster layers such as images and tiles are the least customizable since they are rendered server-side.</p>
<p>Refer to the <a href="./styling/">Styling</a> documentation for more information on customizing the styling used for your map’s weather data.</p>